<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix B — What about drake? – The {targets} R package user manual</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./markdown.html" rel="next">
<link href="./hpc.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a34d670291f06f286357e447776a572a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hpc.html">Appendices</a></li><li class="breadcrumb-item"><a href="./drake.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">What about <code>drake</code>?</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The {targets} R package user manual</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ropensci-books/targets/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">How to use {targets}</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./walkthrough.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A walkthrough to get started</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Help</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Debugging pipelines</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Concepts and best practices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./targets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Targets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pseudo-random numbers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data and files</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Local data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cloud-storage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Cloud storage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literate-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Literate programming</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Heavy workloads</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./crew.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Distributed computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Performance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Branching</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Dynamic branching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./static.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Static branching</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">High-performance computing (the old way)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./drake.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">What about <code>drake</code>?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Target Markdown</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-is-drake-superseded" id="toc-why-is-drake-superseded" class="nav-link active" data-scroll-target="#why-is-drake-superseded"><span class="header-section-number">B.1</span> Why is <code>drake</code> superseded?</a></li>
  <li><a href="#transitioning-to-targets" id="toc-transitioning-to-targets" class="nav-link" data-scroll-target="#transitioning-to-targets"><span class="header-section-number">B.2</span> Transitioning to <code>targets</code></a></li>
  <li><a href="#advantages-of-targets-over-drake" id="toc-advantages-of-targets-over-drake" class="nav-link" data-scroll-target="#advantages-of-targets-over-drake"><span class="header-section-number">B.3</span> Advantages of <code>targets</code> over <code>drake</code></a>
  <ul class="collapse">
  <li><a href="#better-guardrails-by-design" id="toc-better-guardrails-by-design" class="nav-link" data-scroll-target="#better-guardrails-by-design"><span class="header-section-number">B.3.1</span> Better guardrails by design</a></li>
  <li><a href="#enhanced-debugging-support" id="toc-enhanced-debugging-support" class="nav-link" data-scroll-target="#enhanced-debugging-support"><span class="header-section-number">B.3.2</span> Enhanced debugging support</a></li>
  <li><a href="#improved-tracking-of-package-functions" id="toc-improved-tracking-of-package-functions" class="nav-link" data-scroll-target="#improved-tracking-of-package-functions"><span class="header-section-number">B.3.3</span> Improved tracking of package functions</a></li>
  <li><a href="#lighter-friendlier-data-management" id="toc-lighter-friendlier-data-management" class="nav-link" data-scroll-target="#lighter-friendlier-data-management"><span class="header-section-number">B.3.4</span> Lighter, friendlier data management</a></li>
  <li><a href="#cloud-storage" id="toc-cloud-storage" class="nav-link" data-scroll-target="#cloud-storage"><span class="header-section-number">B.3.5</span> Cloud storage</a></li>
  <li><a href="#show-status-of-functions-and-global-objects" id="toc-show-status-of-functions-and-global-objects" class="nav-link" data-scroll-target="#show-status-of-functions-and-global-objects"><span class="header-section-number">B.3.6</span> Show status of functions and global objects</a></li>
  <li><a href="#dynamic-branching-with-dplyrgroup_by" id="toc-dynamic-branching-with-dplyrgroup_by" class="nav-link" data-scroll-target="#dynamic-branching-with-dplyrgroup_by"><span class="header-section-number">B.3.7</span> Dynamic branching with <code>dplyr::group_by()</code></a></li>
  <li><a href="#composable-dynamic-branching" id="toc-composable-dynamic-branching" class="nav-link" data-scroll-target="#composable-dynamic-branching"><span class="header-section-number">B.3.8</span> Composable dynamic branching</a></li>
  <li><a href="#improved-parallel-efficiency" id="toc-improved-parallel-efficiency" class="nav-link" data-scroll-target="#improved-parallel-efficiency"><span class="header-section-number">B.3.9</span> Improved parallel efficiency</a></li>
  <li><a href="#metaprogramming" id="toc-metaprogramming" class="nav-link" data-scroll-target="#metaprogramming"><span class="header-section-number">B.3.10</span> Metaprogramming</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ropensci-books/targets/edit/main/drake.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hpc.html">Appendices</a></li><li class="breadcrumb-item"><a href="./drake.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">What about <code>drake</code>?</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="drake" class="quarto-section-identifier">Appendix B — What about <code>drake</code>?</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://www.tidyverse.org/lifecycle/#superseded"><img src="https://img.shields.io/badge/lifecycle-superseded-blue.svg" alt="superseded lifecycle"></a></p>
<p><a href="https://github.com/ropensci/targets"><code>targets</code></a> is the successor of <a href="https://github.com/ropensci/drake"><code>drake</code></a>, an older pipeline tool. As of 2021-01-21, <a href="https://github.com/ropensci/drake"><code>drake</code></a> is <a href="https://lifecycle.r-lib.org/articles/stages.html#superseded">superseded</a>, which means there are no plans for new features or discretionary enhancements, but basic maintenance and support will continue indefinitely. Existing projects that use <a href="https://github.com/ropensci/drake"><code>drake</code></a> can safely continue to use <a href="https://github.com/ropensci/drake"><code>drake</code></a>, and there is no need to retrofit <a href="https://github.com/ropensci/targets"><code>targets</code></a>. New projects should use <a href="https://github.com/ropensci/targets"><code>targets</code></a> because it is friendlier and more robust.</p>
<section id="why-is-drake-superseded" class="level2" data-number="B.1">
<h2 data-number="B.1" class="anchored" data-anchor-id="why-is-drake-superseded"><span class="header-section-number">B.1</span> Why is <code>drake</code> superseded?</h2>
<p>Nearly four years of community feedback have exposed major user-side limitations regarding data management, collaboration, dynamic branching, and parallel efficiency. Unfortunately, these limitations are permanent. Solutions in <a href="https://github.com/ropensci/drake"><code>drake</code></a> itself would make the package incompatible with existing projects that use it, and the internal architecture is too copious, elaborate, and mature for such extreme refactoring. That is why <a href="https://github.com/ropensci/targets"><code>targets</code></a> was created. The <a href="https://github.com/ropensci/targets"><code>targets</code></a> package borrows from past learnings, user suggestions, discussions, complaints, success stories, and feature requests, and it improves the user experience in ways that will never be possible in <a href="https://github.com/ropensci/drake"><code>drake</code></a>.</p>
</section>
<section id="transitioning-to-targets" class="level2" data-number="B.2">
<h2 data-number="B.2" class="anchored" data-anchor-id="transitioning-to-targets"><span class="header-section-number">B.2</span> Transitioning to <code>targets</code></h2>
<p>If you know <a href="https://github.com/ropensci/drake"><code>drake</code></a>, then you already almost know <code>targets</code>. The programming style is similar, and most functions in <code>targets</code> have counterparts in <a href="https://github.com/ropensci/drake"><code>drake</code></a>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Functions in <code>drake</code></th>
<th>Counterparts in <code>targets</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/use_drake.html"><code>use_drake()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_script.html"><code>drake_script()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_script.html"><code>tar_script()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_plan.html"><code>drake_plan()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_manifest.html"><code>tar_manifest()</code></a>, <a href="https://docs.ropensci.org/tarchetypes/reference/tar_plan.html"><code>tarchetypes::tar_plan()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/target.html"><code>target()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_target_raw.html"><code>tar_target_raw()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_config.html"><code>drake_config()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/outdated.html"><code>outdated()</code></a>, <a href="https://docs.ropensci.org/drake/reference/r_make.html"><code>r_outdated()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_outdated.html"><code>tar_outdated()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/vis_drake_graph.html"><code>vis_drake_graph()</code></a>, <a href="https://docs.ropensci.org/drake/reference/r_make.html"><code>r_vis_drake_graph()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_visnetwork.html"><code>tar_visnetwork()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_glimpse.html"><code>tar_glimpse()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/drake_graph_info.html"><code>drake_graph_info()</code></a>, <a href="https://docs.ropensci.org/drake/reference/r_make.html"><code>r_drake_graph_info()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_network.html"><code>tar_network()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/make.html"><code>make()</code></a>, <a href="https://docs.ropensci.org/drake/reference/r_make.html"><code>r_make()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_make.html"><code>tar_make()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_make_clustermq.html"><code>tar_make_clustermq()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_make_future.html"><code>tar_make_future()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/readd.html"><code>loadd()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_load.html"><code>tar_load()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/readd.html"><code>readd()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_read.html"><code>tar_read()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/diagnose.html"><code>diagnose()</code></a>, <a href="https://docs.ropensci.org/drake/reference/build_times.html"><code>build_times()</code></a>, <a href="https://docs.ropensci.org/drake/reference/cached.html"><code>cached()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_cache_log.html"><code>drake_cache_log()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_meta.html"><code>tar_meta()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_progress.html"><code>drake_progress()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_running.html"><code>drake_running()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_done.html"><code>drake_done()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_failed.html"><code>drake_failed()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_cancelled.html"><code>drake_cancelled()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_progress.html"><code>tar_progress()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/clean.html"><code>clean()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_deduplicate.html"><code>tar_deduplicate()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_delete.html"><code>tar_delete()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_destroy.html"><code>tar_destroy()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_invalidate.html"><code>tar_invalidate()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_gc.html"><code>drake_gc()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_prune.html"><code>tar_prune()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/id_chr.html"><code>id_chr()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_name.html"><code>tar_name()</code></a>, <a href="https://docs.ropensci.org/targets/reference/tar_path.html"><code>tar_path()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/knitr_in.html"><code>knitr_in()</code></a></td>
<td><a href="https://docs.ropensci.org/tarchetypes/reference/tar_render.html"><code>tarchetypes::tar_render()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/cancel.html"><code>cancel()</code></a>, <a href="https://docs.ropensci.org/drake/reference/cancel_if.html"><code>cancel_if()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_cancel.html"><code>tar_cancel()</code></a></td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/trigger.html"><code>trigger()</code></a></td>
<td><a href="https://docs.ropensci.org/targets/reference/tar_cue.html"><code>tar_cue()</code></a></td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/drake_example.html"><code>drake_example()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_examples.html"><code>drake_example()</code></a>, <a href="https://docs.ropensci.org/drake/reference/load_mtcars_example.html"><code>load_mtcars_example()</code></a>, <a href="https://docs.ropensci.org/drake/reference/clean_mtcars_example.html"><code>clean_mtcars_example()</code></a></td>
<td>Unsupported. Example <code>targets</code> pipelines are in individual repositories <a href="https://docs.ropensci.org/targets/index.html#examples">linked from here</a>.</td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_build.html"><code>drake_build()</code></a></td>
<td>Unsupported in <code>targets</code> to ensure coherence with dynamic branching.</td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/drake_debug.html"><code>drake_debug()</code></a></td>
<td>See the <a href="#debug">debugging chapter</a>.</td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_history.html"><code>drake_history()</code></a>, <a href="https://docs.ropensci.org/drake/reference/recoverable.html"><code>recoverable()</code></a></td>
<td>Unsupported in <code>targets</code>. Instead of trying to manage history and data recovery directly, <a href="https://github.com/ropensci/targets"><code>targets</code></a> maintains a much lighter/friendlier data store to make it easier to use external data versioning tools instead.</td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/missed.html"><code>missed()</code></a>, <a href="https://docs.ropensci.org/drake/reference/tracked.html"><code>tracked()</code></a>, <a href="https://docs.ropensci.org/drake/reference/deps_code.html"><code>deps_code()</code></a>, <a href="https://docs.ropensci.org/drake/reference/deps_target.html"><code>deps_target()</code></a>, <a href="https://docs.ropensci.org/drake/reference/deps_knitr.html"><code>deps_knitr()</code></a>, <a href="https://docs.ropensci.org/drake/reference/deps_profile.html"><code>deps_profile()</code></a></td>
<td>Unsupported in <code>targets</code> because dependency detection is <a href="targets.html">easier to understand</a> than in <code>drake</code>.</td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_hpc_template_file.html"><code>drake_hpc_template_file()</code></a>, <a href="https://docs.ropensci.org/drake/reference/drake_hpc_template_files.html"><code>drake_hpc_template_files()</code></a></td>
<td>Deemed out of scope for <code>targets</code>.</td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/drake_cache.html"><code>drake_cache()</code></a>, <a href="https://docs.ropensci.org/drake/reference/new_cache.html"><code>new_cache()</code></a>, <a href="https://docs.ropensci.org/drake/reference/find_cache.html"><code>find_cache()</code></a>.</td>
<td>Unsupported because <a href="https://github.com/ropensci/targets"><code>targets</code></a> is far more strict and paternalistic about data/file management.</td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/rescue_cache.html"><code>rescue_cache()</code></a>, <a href="https://docs.ropensci.org/drake/reference/which_clean.html"><code>which_clean()</code></a>, <a href="https://docs.ropensci.org/drake/reference/cached_planned.html"><code>cache_planned()</code></a>, <a href="https://docs.ropensci.org/drake/reference/cached_unplanned.html"><code>cache_unplanned()</code></a></td>
<td>Unsupported due to the simplified data management system and storage cleaning functions.</td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/drake_get_session_info.html"><code>drake_get_session_info()</code></a></td>
<td>Deemed superfluous and a potential bottleneck. Discarded for <code>targets</code>.</td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/read_drake_seed.html"><code>read_drake_seed()</code></a></td>
<td>Superfluous because <code>targets</code> always uses the same global seed. <a href="https://docs.ropensci.org/targets/reference/tar_meta.html"><code>tar_meta()</code></a> shows all the target-level seeds.</td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/show_source.html"><code>show_source()</code></a></td>
<td>Deemed superfluous. Discarded in <code>targets</code> to conserve storage space in <code>_targets/meta/meta</code>.</td>
</tr>
<tr class="even">
<td><a href="https://docs.ropensci.org/drake/reference/drake_tempfile.html"><code>drake_tempfile()</code></a></td>
<td>Superfluous in <code>targets</code> because there is no special <code>disk.frame</code> storage format. (<a href="https://books.ropensci.org/targets/files.html#external-output-files">Dynamic file targets</a> are much better for managing <code>disk.frame</code>s.)</td>
</tr>
<tr class="odd">
<td><a href="https://docs.ropensci.org/drake/reference/file_store.html"><code>file_store()</code></a></td>
<td>Superfluous in <code>targets</code> because <a href="https://books.ropensci.org/targets/files.html">all files are dynamic files</a> and there is no longer a need to Base32-encode any file names.</td>
</tr>
</tbody>
</table>
<p>Likewise, many <code>make()</code> arguments have equivalent arguments elsewhere.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Argument of <code>drake::make()</code></th>
<th>Counterparts in <code>targets</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>targets</code></td>
<td><code>names</code> in <a href="https://docs.ropensci.org/targets/reference/tar_make.html"><code>tar_make()</code></a> etc.</td>
</tr>
<tr class="even">
<td><code>envir</code></td>
<td><code>envir</code> in <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>verbose</code></td>
<td><code>reporter</code> in <a href="https://docs.ropensci.org/targets/reference/tar_make.html"><code>tar_make()</code></a> etc.</td>
</tr>
<tr class="even">
<td><code>parallelism</code></td>
<td>Choice of function: <a href="https://docs.ropensci.org/targets/reference/tar_make.html"><code>tar_make()</code></a> vs <a href="https://docs.ropensci.org/targets/reference/tar_make_clustermq.html"><code>tar_make_clustermq()</code></a> vs <a href="https://docs.ropensci.org/targets/reference/tar_make_future.html"><code>tar_make_future()</code></a></td>
</tr>
<tr class="odd">
<td><code>jobs</code></td>
<td><code>workers</code> in <a href="https://docs.ropensci.org/targets/reference/tar_make_clustermq.html"><code>tar_make_clustermq()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_make_future.html"><code>tar_make_future()</code></a></td>
</tr>
<tr class="even">
<td><code>packages</code></td>
<td><code>packages</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>lib_loc</code></td>
<td><code>library</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="even">
<td><code>trigger</code></td>
<td><code>cue</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>caching</code></td>
<td><code>storage</code> and <code>retrieval</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="even">
<td><code>keep_going</code></td>
<td><code>error</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>memory_strategy</code></td>
<td><code>memory</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="even">
<td><code>garbage_collection</code></td>
<td><code>garbage_collection</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>template</code></td>
<td><code>resources</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a>, along with helpers like <a href="https://docs.ropensci.org/targets/reference/tar_resources.html"><code>tar_resources()</code></a>.</td>
</tr>
<tr class="even">
<td><code>curl_handles</code></td>
<td><code>handle</code> element of <code>resources</code> argument of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>format</code></td>
<td><code>format</code> in <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="even">
<td><code>seed</code></td>
<td>Superfluous because targets always uses the same global seed. [<code>tar_meta()</code>] shows all the target-level seeds.</td>
</tr>
</tbody>
</table>
<p>In addition, many <a href="https://books.ropensci.org/drake/plans.html#special-columns">optional columns of <code>drake</code> plans</a> are expressed differently in <code>targets</code>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><a href="https://books.ropensci.org/drake/plans.html#special-columns">Optional column of <code>drake</code> plans</a></th>
<th>Feature in <code>targets</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>format</code></td>
<td><code>format</code> argument of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="even">
<td><code>dynamic</code></td>
<td><code>pattern</code> argument of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>transform</code></td>
<td><a href="https://docs.ropensci.org/tarchetypes/reference/index.html#section-branching">static branching functions in <code>tarchetypes</code></a> such as <a href="https://docs.ropensci.org/tarchetypes/reference/tar_map.html"><code>tar_map()</code></a> and <a href="https://docs.ropensci.org/tarchetypes/reference/tar_combine.html"><code>tar_combine()</code></a></td>
</tr>
<tr class="even">
<td><code>trigger</code></td>
<td><code>cue</code> argument of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>hpc</code></td>
<td><code>deployment</code> argument of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="even">
<td><code>resources</code></td>
<td><code>resources</code> argument of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
<tr class="odd">
<td><code>caching</code></td>
<td><code>storage</code> and <code>retrieval</code> arguments of <a href="https://docs.ropensci.org/targets/reference/tar_target.html"><code>tar_target()</code></a> and <a href="https://docs.ropensci.org/targets/reference/tar_option_set.html"><code>tar_option_set()</code></a></td>
</tr>
</tbody>
</table>
</section>
<section id="advantages-of-targets-over-drake" class="level2" data-number="B.3">
<h2 data-number="B.3" class="anchored" data-anchor-id="advantages-of-targets-over-drake"><span class="header-section-number">B.3</span> Advantages of <code>targets</code> over <code>drake</code></h2>
<section id="better-guardrails-by-design" class="level3" data-number="B.3.1">
<h3 data-number="B.3.1" class="anchored" data-anchor-id="better-guardrails-by-design"><span class="header-section-number">B.3.1</span> Better guardrails by design</h3>
<p><a href="https://github.com/ropensci/drake"><code>drake</code></a> leaves ample room for user-side mistakes, and some of these mistakes require extra awareness or advanced knowledge of R to consistently avoid. The example behaviors below are too systemic to solve and still preserve back-compatibility.</p>
<ol type="1">
<li>By default, <code>make()</code> looks for functions and global objects in the parent environment of the calling R session. Because the global environment is often old and stale in practical situations, which causes targets to become incorrectly invalidated. Users need to remember to restart the session before calling <code>make()</code>. The issue is <a href="https://github.com/ropensci/drake/issues/761">discussed here</a>, and the discussion led to functions like <code>r_make()</code> which always create a fresh session to do the work. However, <code>r_make()</code> is not a complete replacement for <code>make()</code>, and beginner users still run into the original problems.</li>
<li>Similar to the above, <code>make()</code> does not find the intended functions and global objects if it is called in a different environment. Edge cases like <a href="https://github.com/ropensci/drake/issues/874">this one</a> and <a href="https://github.com/ropensci/drake/issues/527">this one</a> continue to surprise users.</li>
<li><a href="https://github.com/ropensci/drake"><code>drake</code></a> is extremely flexible about the location of the <code>.drake/</code> cache. When a user calls <code>readd()</code>, <code>loadd()</code>, <code>make()</code>, and similar functions, <a href="https://github.com/ropensci/drake"><code>drake</code></a> searches up through the parent directories until it finds a <code>.drake/</code> folder. This flexibility seldom helps, and it creates uncertainty and inconsistency when it comes to initializing and accessing projects, especially if there are multiple projects with nested file systems.</li>
</ol>
<p>The <a href="https://github.com/ropensci/targets"><code>targets</code></a> package solves all these issues by design. Functions <code>tar_make()</code>, <code>tar_make_clustermq()</code>, and <code>tar_make_future()</code> all create fresh new R sessions by default. They all require a <code>_targets.R</code> configuration file in the project root (working directory of the <code>tar_make()</code> call) so that the functions, global objects, and settings are all populated in the exact same way each session, leading to less frustration, greater consistency, and greater reproducibility. In addition, the <code>_targets/</code> data store always lives in the project root.</p>
</section>
<section id="enhanced-debugging-support" class="level3" data-number="B.3.2">
<h3 data-number="B.3.2" class="anchored" data-anchor-id="enhanced-debugging-support"><span class="header-section-number">B.3.2</span> Enhanced debugging support</h3>
<p><a href="https://github.com/ropensci/targets"><code>targets</code></a> has enhanced debugging support. With the <code>workspaces</code> argument to <code>tar_option_set()</code>, users can locally recreate the conditions under which a target runs. This includes packages, global functions and objects, and the random number generator seed. Similarly, <code>tar_option_set(error = "workspace")</code> automatically saves debugging workspaces for targets that encounter errors. The <code>debug</code> option lets users enter an interactive debugger for a given target while the pipeline is running. And unlike <code>drake</code>, all debugging features are fully compatible with dynamic branching.</p>
</section>
<section id="improved-tracking-of-package-functions" class="level3" data-number="B.3.3">
<h3 data-number="B.3.3" class="anchored" data-anchor-id="improved-tracking-of-package-functions"><span class="header-section-number">B.3.3</span> Improved tracking of package functions</h3>
<p>By default, <a href="https://github.com/ropensci/targets"><code>targets</code></a> ignores changes to functions inside external packages. However, if a workflow centers on a custom package with methodology under development, users can make <a href="https://github.com/ropensci/targets"><code>targets</code></a> automatically watch the package’s functions for changes. Simply supply the names of the relevant packages to the <code>imports</code> argument of <code>tar_option_set()</code>. Unlike <a href="https://github.com/ropensci/drake"><code>drake</code></a>, <a href="https://github.com/ropensci/targets"><code>targets</code></a> can track multiple packages this way, and the internal mechanism is much safer.</p>
</section>
<section id="lighter-friendlier-data-management" class="level3" data-number="B.3.4">
<h3 data-number="B.3.4" class="anchored" data-anchor-id="lighter-friendlier-data-management"><span class="header-section-number">B.3.4</span> Lighter, friendlier data management</h3>
<p><a href="https://github.com/ropensci/drake"><code>drake</code></a>’s cache is an intricate file system in a hidden <code>.drake</code> folder. It contains multiple files for each target, and those names are not informative. (See the files in the <code>data/</code> folder in the diagram below.) Users often have trouble understanding how <a href="https://github.com/ropensci/drake"><code>drake</code></a> manages data, resolving problems when files are corrupted, placing the data under version control, collaborating with others on the same pipeline, and clearing out superfluous data when the cache grows large in storage.</p>
<pre><code>.drake/
├── config/
├── data/
├───── 17bfcef645301416.rds
├───── 21935c86f12692e2.rds
├───── 37caf5df2892cfc4.rds
├───── ...
├── drake/
├───── history/
├───── return/
├───── tmp/
├── keys/ # A surprisingly large number of tiny text files live here.
├───── memoize/
├───── meta/
├───── objects/
├───── progress/
├───── recover/
├───── session/
└── scratch/ # This folder should be temporary, but it gets egregiously large.</code></pre>
<p>The <a href="https://github.com/ropensci/targets"><code>targets</code></a> takes a friendlier, more transparent, less mysterious approach to data management. Its data store is a visible <code>_targets</code> folder, and it contains far fewer files: a spreadsheet of metadata, a spreadsheet of target progress, and one informatively named data file for each target. It is much easier to understand the data management process, identify and diagnose problems, place projects under version control, and avoid consuming unnecessary storage resources. Sketch:</p>
<pre><code>_targets/
├── meta/
├───── meta
├───── process
├───── progress
├── objects/
├───── target_name_1
├───── target_name_2
├───── target_name_3
├───── ...
├── scratch/ # tar_make() deletes this folder after it finishes.
└── user/ # gittargets users can put custom files here for data version control.</code></pre>
</section>
<section id="cloud-storage" class="level3" data-number="B.3.5">
<h3 data-number="B.3.5" class="anchored" data-anchor-id="cloud-storage"><span class="header-section-number">B.3.5</span> Cloud storage</h3>
<p>Thanks to the simplified data store and simplified internals, <a href="https://github.com/ropensci/targets"><code>targets</code></a> can automatically upload data to the Amazon S3 bucket of your choice. Simply configure <a href="https://github.com/cloudyr/aws.s3"><code>aws.s3</code></a>, create a bucket, and select one of the AWS-powered storage formats. Then, <a href="https://github.com/ropensci/targets"><code>targets</code></a> will automatically upload the return values to the cloud.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_option_set</span>(<span class="at">resources =</span> <span class="fu">list</span>(<span class="at">bucket =</span> <span class="st">"my-bucket-name"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(dataset, <span class="fu">get_large_dataset</span>(), <span class="at">format =</span> <span class="st">"aws_fst_tbl"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(analysis, <span class="fu">analyze_dataset</span>(dataset), <span class="at">format =</span> <span class="st">"aws_qs"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Data retrieval is still super easy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_read</span>(dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="show-status-of-functions-and-global-objects" class="level3" data-number="B.3.6">
<h3 data-number="B.3.6" class="anchored" data-anchor-id="show-status-of-functions-and-global-objects"><span class="header-section-number">B.3.6</span> Show status of functions and global objects</h3>
<p><a href="https://github.com/ropensci/drake"><code>drake</code></a> has several utilities that inform users which targets are up to date and which need to rerun. However, those utilities are limited by how <a href="https://github.com/ropensci/drake"><code>drake</code></a> manages functions and other global objects. Whenever <a href="https://github.com/ropensci/drake"><code>drake</code></a> inspects globals, it stores their values in its cache and loses track of their previous state from the last run of the pipeline. As a result, it has trouble informing users exactly why a given target is out of date. And because the system for tracking global objects is tightly coupled with the cache, this limitation is permanent.</p>
<p>In <a href="https://github.com/ropensci/targets"><code>targets</code></a>, the metadata management system only updates information on global objects when the pipeline actually runs. This makes it possible to understand which specific changes to your code could have invalided your targets. In large projects with long runtimes, this feature contributes significantly to reproducibility and peace of mind.</p>
<p><img src="./man/figures/drake-graph.png" class="img-fluid"></p>
</section>
<section id="dynamic-branching-with-dplyrgroup_by" class="level3" data-number="B.3.7">
<h3 data-number="B.3.7" class="anchored" data-anchor-id="dynamic-branching-with-dplyrgroup_by"><span class="header-section-number">B.3.7</span> Dynamic branching with <code>dplyr::group_by()</code></h3>
<p><a href="https://books.ropensci.org/drake/dynamic.html">Dynamic branching</a> was an architecturally difficult fit in <a href="https://github.com/ropensci/drake"><code>drake</code></a>, and it can only support one single (<a href="https://github.com/r-lib/vctrs"><code>vctrs</code></a>-based) method of slicing and aggregation for processing sub-targets. This limitation has frustrated members of the community, as discussed <a href="https://github.com/ropensci/drake/issues/1087">here</a> and <a href="https://github.com/ropensci/drake/issues/1170">here</a>.</p>
<p><a href="https://github.com/ropensci/targets"><code>targets</code></a>, on the other hand, is more flexible regarding slicing and aggregation. When it branches over an object, it can iterate over vectors, lists, and even data frames grouped with <code>dplyr::group_by()</code>. To branch over chunks of a data frame, our data frame target needs to have a special <code>tar_group</code> column. We can create this column in our target’s return value with the <code>tar_group()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="dv">6</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">rep</span>(letters[<span class="fu">seq_len</span>(<span class="dv">3</span>)], <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_group</span>()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x id    tar_group</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1 a             1</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2 a             1</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     3 b             2</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     4 b             2</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     5 c             3</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     6 c             3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our actual target has the command above and <code>iteration = "group"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="dv">6</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">rep</span>(letters[<span class="fu">seq_len</span>(<span class="dv">3</span>)], <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tar_group</span>(),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iteration =</span> <span class="st">"group"</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, any target that maps over <code>data</code> is going to define one branch for each group in the data frame. The following target creates three branches when run in a pipeline: one returning 3, one returning 7, and one returning 11.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  sums,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(data<span class="sc">$</span>x),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="fu">map</span>(data)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="composable-dynamic-branching" class="level3" data-number="B.3.8">
<h3 data-number="B.3.8" class="anchored" data-anchor-id="composable-dynamic-branching"><span class="header-section-number">B.3.8</span> Composable dynamic branching</h3>
<p>Because the design of <a href="https://github.com/ropensci/targets"><code>targets</code></a> is fundamentally dynamic, users can create complicated dynamic branching patterns that are never going to be possible in <code>drake</code>. Below, target <code>z</code> creates six branches, one for each combination of <code>w</code> and tuple (<code>x</code>, <code>y</code>). The pattern <code>cross(w, map(x, y))</code> is equivalent to <code>tidyr::crossing(w, tidyr::nesting(x, y))</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(w, <span class="fu">seq_len</span>(<span class="dv">2</span>)),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(x, <span class="fu">head</span>(letters, <span class="dv">3</span>)),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(y, <span class="fu">head</span>(LETTERS, <span class="dv">3</span>)),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    z,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">w =</span> w, <span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="fu">cross</span>(w, <span class="fu">map</span>(x, y))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thanks to <a href="https://github.com/glep"><code>glep</code></a> and <a href="https://github.com/djbirke"><code>djbirke</code></a> on GitHub for the idea.</p>
</section>
<section id="improved-parallel-efficiency" class="level3" data-number="B.3.9">
<h3 data-number="B.3.9" class="anchored" data-anchor-id="improved-parallel-efficiency"><span class="header-section-number">B.3.9</span> Improved parallel efficiency</h3>
<p><a href="https://books.ropensci.org/drake/dynamic.html">Dynamic branching</a> in <a href="https://github.com/ropensci/drake"><code>drake</code></a> is staged. In other words, all the sub-targets of a dynamic target must complete before the pipeline moves on to downstream targets. The diagram below illustrates this behavior in a pipeline with a dynamic target B that maps over another dynamic target A. For thousands of dynamic sub-targets with highly variable runtimes, this behavior consumes unnecessary runtime and computing resources. And because <a href="https://github.com/ropensci/drake"><code>drake</code></a>’s architecture was designed at a fundamental level for static branching only, this limitation is permanent.</p>
<p><img src="./man/figures/drake-dynamic-drake.png" class="img-fluid"></p>
<p>By contrast, the internal data structures in <a href="https://github.com/ropensci/targets"><code>targets</code></a> are dynamic by design, which allows for a dynamic branching model with more flexibility and parallel efficiency. Branches can always start as soon as their upstream dependencies complete, even if some of those upstream dependencies are branches. This behavior reduces runtime and reduces consumption of computing resources.</p>
<p><img src="./man/figures/drake-dynamic-targets.png" class="img-fluid"></p>
</section>
<section id="metaprogramming" class="level3" data-number="B.3.10">
<h3 data-number="B.3.10" class="anchored" data-anchor-id="metaprogramming"><span class="header-section-number">B.3.10</span> Metaprogramming</h3>
<p>In <a href="https://github.com/ropensci/drake"><code>drake</code></a>, pipelines are defined with the <code>drake_plan()</code> function. <code>drake_plan()</code> supports an elaborate domain specific language that diffuses user-supplied R expressions. This makes it convenient to assign commands to targets in the vast majority of cases, but it also obstructs custom metaprogramming by users (<a href="https://github.com/ropensci/drake/issues/1251">example here</a>). Granted, it is possible to completely circumvent <code>drake_plan()</code> and create the whole data frame from scratch, but this is hardly ideal and seldom done in practice.</p>
<p>The <a href="https://github.com/ropensci/targets"><code>targets</code></a> package tries to make customization easier. Relative to <a href="https://github.com/ropensci/drake"><code>drake</code></a>, <a href="https://github.com/ropensci/targets"><code>targets</code></a> takes a decentralized approach to setting up pipelines, moving as much custom configuration as possible to the target level rather than the whole pipeline level. In addition, the <code>tar_target_raw()</code> function avoids non-standard evaluation while mirroring <code>tar_target()</code> in all other respects. All this makes it much easier to create <a href="https://books.ropensci.org/targets/static.html#metaprogram">custom metaprogrammed pipelines</a> and <a href="https://github.com/ropensci/tarchetypes">target archetypes</a> while avoiding an elaborate domain specific language for <a href="https://books.ropensci.org/drake/static.html">static branching</a>, which was extremely difficult to understand and error prone in <a href="https://github.com/ropensci/drake"><code>drake</code></a>. The <a href="https://wlandau.github.io/targetopia.html">R Targetopia</a> is an emerging ecosystem of workflow frameworks that take full advantage of this customization and democratize reproducible pipelines.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/books\.ropensci\.org\/targets\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./hpc.html" class="pagination-link" aria-label="High-performance computing (the old way)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">High-performance computing (the old way)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./markdown.html" class="pagination-link" aria-label="Target Markdown">
        <span class="nav-page-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Target Markdown</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>How to get help: <a href="https://books.ropensci.org/targets/help.html" class="uri">https://books.ropensci.org/targets/help.html</a><br>Copyright 2024, Eli Lilly and Company</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ropensci-books/targets/edit/main/drake.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>